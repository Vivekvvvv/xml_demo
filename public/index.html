<!doctype html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>社区书店 XML 管理</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>社区书店借阅（XML + XSD + XSLT + AJAX）</h1>

    <div class="panel inline-controls" style="justify-content: space-between; align-items: center;">
      <div>当前登录：<strong id="user-name">--</strong></div>
      <div class="inline-controls">
        <button id="btn-manage-users" class="ghost" hidden>管理账号</button>
        <button id="btn-logout" class="danger">退出</button>
      </div>
    </div>

    <div class="panel">
      <h3>分页浏览 + CRUD（AJAX + JSON）</h3>
      <div class="paged-layout">
        <div class="paged-list">
          <div class="paged-header">
            <div class="flex paged-controls">
              <div class="control-field">
                <label>每页条目</label>
                <input id="page-size" type="number" value="5" min="1" max="20">
              </div>
              <div class="control-field">
                <label>排序字段</label>
                <select id="page-sort-field">
                  <option value="title">title</option>
                  <option value="price">price</option>
                  <option value="publishYear">publishYear</option>
                  <option value="stock">stock</option>
                </select>
              </div>
              <div class="control-field">
                <label>排序方向</label>
                <select id="page-sort-order">
                  <option value="asc">升序</option>
                  <option value="desc">降序</option>
                </select>
              </div>
            </div>
            <button type="button" class="success" id="btn-add">新增图书</button>
          </div>
          <div class="search-bar">
            <div class="control-field">
              <label>查询字段</label>
              <select id="search-field">
                <option value="title">title</option>
                <option value="author">author</option>
                <option value="category">category</option>
                <option value="publishYear">publishYear</option>
              </select>
            </div>
            <div class="control-field">
              <label>匹配方式</label>
              <select id="search-mode">
                <option value="contains">模糊</option>
                <option value="exact">精确</option>
              </select>
            </div>
            <div class="control-field flex-2">
              <label>关键字</label>
              <input id="search-keyword" type="text" placeholder="输入关键字">
            </div>
            <div class="search-actions">
              <button type="button" id="btn-search" class="primary">查询</button>
              <button type="button" id="btn-reset-search" class="ghost">重置</button>
            </div>
          </div>
          <div class="inline-controls pager-controls">
            <button id="btn-prev">上一页</button>
            <button id="btn-next">下一页</button>
            <span id="page-info" class="info"></span>
          </div>
          <div id="paged-table" class="table"></div>
        </div>
      </div>
    </div>

    <div class="panel" id="admin-panel" hidden>
      <h3>用户管理（管理员）</h3>
      <p class="info">仅管理员可见，可在此查看、切换角色或删除普通账号。</p>
      <div class="inline-controls" style="justify-content: space-between; flex-wrap: wrap;">
        <button id="btn-user-refresh" type="button">刷新用户列表</button>
        <span id="user-panel-status" class="status"></span>
      </div>
      <div id="user-table" class="table"></div>
    </div>

  </div>

  <div id="book-modal" class="modal">
    <div class="modal-backdrop" data-close-modal></div>
    <div class="modal-content">
      <div class="modal-header">
        <h4 id="crud-card-title">操作表单</h4>
        <button type="button" class="ghost close-btn" id="modal-close" aria-label="关闭表单">&times;</button>
      </div>
      <p id="crud-card-hint" class="crud-hint">点击“新增图书”或某一行的“更新”按钮后再填写</p>
      <div class="flex form-grid">
        <div class="form-column">
          <label>书号</label><input id="form-id" placeholder="如 BK-0001">
          <label>书名</label><input id="form-title">
          <label>作者</label><input id="form-author">
        </div>
        <div class="form-column">
          <label>分类</label><input id="form-category">
          <label>价格</label><input id="form-price" type="number" step="0.1">
          <label>年份</label><input id="form-year" type="number">
          <label>库存</label><input id="form-stock" type="number">
        </div>
      </div>
      <div class="inline-controls form-actions">
        <button class="primary" type="button" id="btn-save" disabled>保存</button>
        <button class="ghost" type="button" id="btn-cancel">取消</button>
        <span id="form-status" class="status"></span>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
