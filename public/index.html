<!doctype html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>社区书店 XML 管理</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>社区书店借阅 / 图书管理（XML + XSD + XSLT + AJAX）</h1>

    <div class="panel inline-controls" style="justify-content: space-between; align-items: center;">
      <div>当前登录：<strong id="user-name">--</strong></div>
      <button id="btn-logout" class="danger">退出</button>
    </div>

    <div class="panel">
      <p class="info">后端数据存储在 XML，并受 <code>data/books.xsd</code> 约束；前端通过 AJAX 调用 Node.js API，XSLT 在浏览器端渲染表格，XPath 支持精确/模糊查询。</p>
    </div>

    <div class="panel">
      <h3>整体浏览（XSLT 排序）</h3>
      <div class="inline-controls">
        <label>排序字段
          <select id="xslt-sort-field">
            <option value="price">price</option>
            <option value="title">title</option>
            <option value="author">author</option>
            <option value="publishYear">publishYear</option>
            <option value="stock">stock</option>
          </select>
        </label>
        <label>方向
          <select id="xslt-sort-order">
            <option value="asc">升序</option>
            <option value="desc">降序</option>
          </select>
        </label>
        <button id="btn-xslt-refresh">刷新</button>
      </div>
      <div id="xslt-table" class="table"></div>
    </div>

    <div class="panel">
      <h3>分页浏览 + CRUD（AJAX + JSON）</h3>
      <div class="paged-layout">
        <div class="paged-list">
          <div class="flex">
            <div class="control-field">
              <label>每页条目</label>
              <input id="page-size" type="number" value="5" min="1" max="20">
            </div>
            <div class="control-field">
              <label>排序字段</label>
              <select id="page-sort-field">
                <option value="title">title</option>
                <option value="price">price</option>
                <option value="publishYear">publishYear</option>
                <option value="stock">stock</option>
              </select>
            </div>
            <div class="control-field">
              <label>排序方向</label>
              <select id="page-sort-order">
                <option value="asc">升序</option>
                <option value="desc">降序</option>
              </select>
            </div>
          </div>
          <div class="inline-controls pager-controls">
            <button id="btn-prev">上一页</button>
            <button id="btn-next">下一页</button>
            <span id="page-info" class="info"></span>
          </div>
          <div id="paged-table" class="table"></div>
        </div>
        <div class="crud-card">
          <h4>添加 / 更新 / 删除</h4>
          <div class="flex form-grid">
            <div class="form-column">
              <label>书号</label><input id="form-id" placeholder="如 BK-0001">
              <label>书名</label><input id="form-title">
              <label>作者</label><input id="form-author">
            </div>
            <div class="form-column">
              <label>分类</label><input id="form-category">
              <label>价格</label><input id="form-price" type="number" step="0.1">
              <label>出版年</label><input id="form-year" type="number">
              <label>库存</label><input id="form-stock" type="number">
            </div>
          </div>
          <div class="inline-controls form-actions">
            <button class="success" id="btn-add">添加</button>
            <button id="btn-update">更新</button>
            <button class="danger" id="btn-delete">删除</button>
            <span id="form-status" class="status"></span>
          </div>
        </div>
      </div>
    </div>

    <div class="panel">
      <h3>XPath 查询（后端解析 expr，返回 XML 片段）</h3>
      <div class="flex">
        <div style="flex:1">
          <label>XPath 表达式</label>
          <input id="xpath-input" type="text" value='//book[contains(title,"XML")]'>
          <p class="info">示例：<code>//book[author="王立"]</code> 精确；<code>//book[contains(category,"学")]</code> 模糊。</p>
        </div>
        <div style="width:160px; align-self:flex-end;">
          <button id="btn-xpath">查询</button>
        </div>
      </div>
      <div id="xpath-result" class="table"></div>
    </div>

  </div>

  <script src="app.js"></script>
</body>
</html>
